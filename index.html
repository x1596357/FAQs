<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Faqs by x1596357</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Faqs</h1>
        <h2>Information worth noted </h2>
        <a href="https://github.com/x1596357/FAQs" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="faqs" class="anchor" href="#faqs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FAQs</h1>

<p>Just some questions and answers I want to keep around. I don't want it to be as heavy as blog. You might find some answers here. If you find this page is too long to read, try using find(Ctrl+F).</p>

<h4>
<a id="1-why-linux-man-pages-are-not-complete" class="anchor" href="#1-why-linux-man-pages-are-not-complete" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. Why linux man pages are not complete?</h4>

<p>try update mandb, issue mandb command with root privilidge.</p>

<h4>
<a id="2-how-to-use-automake-and-autoconf" class="anchor" href="#2-how-to-use-automake-and-autoconf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. How to use automake and autoconf?</h4>

<ol>
<li>
<p>create {src,docs,examples,...} folder in your working directory</p>

<p><code># mkdir src</code></p>
</li>
<li>
<p>create your source code</p>

<p><code># vi src/hello.c</code></p>
</li>
<li>
<p>run <code>autoscan</code> to create configure.ac</p>

<pre><code># autoscan
# mv configure.scan configure.ac
</code></pre>
</li>
<li>fill in information of your program in <code>AC_INIT()</code>, add <code>AM_INIT_AUTMAKE</code> the next line, and add output files <code>Makefile</code> and <code>src/Makefile</code> and etc to <code>AC_OUTPUT()</code> at the end. Static and dynamic libraries need some other informations. Check other material.
<code>
AC_INIT(hello,1.0,hello@hello.com)
AM_INIT_AUTOMAKE
...
AC_OUTPUT(Makefile src/Makefile)
</code>
</li>
<li>
<p>create <code>Makefile.am</code> in your working directory and in subdirectories like <code>src/</code> accordingly(applications or libraries).</p>

<p><code># vi Makefile.am</code></p>

<p>with content</p>

<pre><code>AUTOMAKE_OPTIONS = foreign
SUBDIRS = src
</code></pre>

<p><code># vi src/Makefile.am</code></p>

<p>with content(application)</p>

<pre><code>bin_PROGRAMS = hello
hello_SOURCES = hello.c
</code></pre>

<p>with content(dynamic),check other materials for how to write for dynamic libraries and static libraries</p>

<pre><code>bin_PROGRAMS = hello
hello_SOURCES = hello.c
</code></pre>
</li>
<li>
<p>use <code>libtoolize</code> if you are creating libraries</p>

<p><code># libtoolize -f -c</code></p>
</li>
<li>
<p>run <code>aclocal</code>,<code>autoheader</code>,<code>automake</code>,<code>autoconf</code> in order</p>

<pre><code># aclocal
# autoheader
# automake -a
# autoconf
</code></pre>

<p>You should have <code>./configure</code> scripts after this. If transfer these files to other system, you may want to run <code>autoreconf</code> and redo #7. Now you can do <code>./configure;make;make install;make clean;</code></p>
</li>
</ol>

<h4>
<a id="3-how-to-create-and-apply-patch" class="anchor" href="#3-how-to-create-and-apply-patch" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. How to create and apply patch?</h4>

<ol>
<li>
<p>create</p>

<p><code># diff -Nur old/ new/ &gt;%{name}-%{version}-%{fixwhat}.patch</code></p>

<p>eg.</p>

<p><code># diff -Nur hello/ new_hello/ &gt; hello-1.0-fixprint.patch</code></p>
</li>
<li>
<p>apply </p>

<p><code># patch -p0 &lt; %{patchname}.patch</code></p>

<p>or this one. Recommand following one because base directory name may differ.</p>

<pre><code># cd source_dir/
# patch -p1 &lt; ../%{patchname}.patch
</code></pre>
</li>
</ol>

<h4>
<a id="4-how-to-fix-my-linux-system-even-if-boot-partition-is-destroyed" class="anchor" href="#4-how-to-fix-my-linux-system-even-if-boot-partition-is-destroyed" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. How to fix my Linux system even if <code>boot</code> partition is destroyed?</h4>

<ol>
<li><p>Insert a livecd usbstick or dvd (I am using Fedora here). You search how to create one.</p></li>
<li><p>Mount your need-to-be-fix system at <code>/mnt</code></p></li>
<li>
<p>Format and mount <code>boot</code> partition or make a <code>boot</code> folder in <code>/</code></p>

<pre><code># mkfs.ext4 /dev/sdx?(where boot partition is)
# mount /dev/sdx? /mnt/boot
</code></pre>

<p>or</p>

<p><code># cd /mnt/ &amp;&amp; mkdir /mnt/boot/</code></p>
</li>
<li>
<p>Install kernel,dracut(for mkinitrd) and grub2(for grub2-install and grub2-mkconfig),you need to connect to the Internet. Or you can install downloaded rpms of them.</p>

<p><code>sudo dnf install --installroot=/mnt kernel grub2 dracut</code></p>

<p>You should have something like <code>vmlinuz</code> in your <code>/mnt/boot</code> directory</p>
</li>
<li>
<p>Chroot</p>

<pre><code># mount --bind /dev/ /mnt/dev/
# mount --bind /sys/ /mnt/sys/
# mount --bind /proc /mnt/proc/
# chroot /mnt
</code></pre>
</li>
<li>
<p>Make init ramdisk using mkinitrd, you can try <code>mkinitrd</code> get the prompt.</p>

<p><code># mkinitrd /boot/initramfs-4.5.5-201.fc23.x86_64.img 4.5.5-201.fc23.x86_64</code></p>
</li>
<li>
<p>Install bootloader</p>

<pre><code># grub2-install /dev/sdx(Harddisk device, not partition)
# grub2-mkconfig &gt; /boot/grub2/grub.cfg
</code></pre>

<p>You should see some entries is there in <code>grub.cfg</code>. You might want to check <code>/etc/fstab</code> is correct and use <code>sudo chmod 755 /mnt</code> to make sure root have the corrent permission setting. You might have to temporarily disable <code>selinux</code> by setting <code>SELINUX=disabled</code> in <code>/etc/selinux/config</code></p>
</li>
</ol>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/x1596357/FAQs/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/x1596357/FAQs/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/x1596357/FAQs"></a> is maintained by <a href="https://github.com/x1596357">x1596357</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
